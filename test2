STARTHEADER
.
16893
samuel
samuel
8
4096
ENDHEADER
STARTHEADER
./packing.c
33204
samuel
samuel
16
8183
ENDHEADER
STARTPROGRAM

/* LIBRERIAS DEL SISTEMA QUE UTILIZA PACKING.C */
#include <stdio.h>
#include <string.h>
#include <sys/types.h>
#include <sys/stat.h>
#include <dirent.h>
#include <unistd.h>
#include <stdlib.h>
#include <pwd.h>
#include <grp.h>

/*
* Funcion:
* --------------------------
* 
 
* basePath: 
* root:

* return: 
*/

int addHeader(char *data, char *filename)
{
    FILE *fichero;
    fichero = fopen(filename, "a");
    fputs(data, fichero);
    fputs("\n", fichero);
    fclose(fichero);
    return 0;
}

/*
* Funcion:
* --------------------------
* 
 
* basePath: 
* root:

* return: 
*/

int addContent(FILE *data, char *filename)
{
    FILE *fichero;
    int data1;
    fichero = fopen(filename, "a");
    data1 = 0;
    if (data != NULL)
    {
        while ((data1 = fgetc(data)) != EOF)
        {
            fputc(data1, fichero);
        }
    }
    fputs("\n", fichero);
    fclose(data);
    fclose(fichero);
    return 0;
}

/*
* Funcion: recursiveTree
* --------------------------
* Encargada de hacer un recorrido por todo el arbol de directorio y de archivos, es decir,
  pasando por cada archivo/directorio dentro de una direccion en especifico.
 
* basePath: La direccion base por la que comenzara el recorrido del arbol
* filename
* root: Un entero que representa el nivel del arbol.
* n: Es el identificador del flag n
* v: Es el identificador del flag v

* return: nada.
*/

void packing(char *basePath, char *filename, const int root, int n, int v)
{
    /* Se encarga de inicializar las variables que usaremos en el recorrido */
    int i;
    char path[1000];
    char str[255];
    char buff[10000];

    /* Crea un struct dirent que contiene informacion del directorio */
    struct dirent *dp;

    /* Inicializan variables para poder conocer informacion del archivo */
    struct stat st;
    struct passwd *pws;
    struct group *grp;
    mode_t mode;

    /* Se crea variable que contendra el archivo a empaquetar */
    FILE *fichero;

    /* Inicializa directorios a recorrer */
    DIR *dir;

    /* Abre lo que se encuentre en la direccion que se pasa por argumento */
    fichero = fopen(basePath, "r");
    if (fichero != NULL)
    {
        /* Consigue el stat de lo que pasamos como argumento y lo linkea a nuestra variable personal creada para el caso */
        stat(basePath, &st);

        /* Encuentra el mode, para verificar que tipo de archivo tenemos a la mano */
        mode = st.st_mode;

        if (S_ISDIR(mode))
        {
            /* Si es directorio */
            strcpy(str, basePath);

            /* Comienza el copiado del header en el archivo a empaquetar */
            addHeader("STARTHEADER", filename);

            /* Agrega direccion relativa del archivo o directorio */
            addHeader(str, filename);

            /* Agrega el modo del archivo */
            sprintf(buff, "%i", st.st_mode);
            addHeader(buff, filename);

            /* Agrega el username del dueño del archivo */
            pws = getpwuid(st.st_uid);
            sprintf(buff, "%s", pws->pw_name);
            addHeader(buff, filename);

            /* Agrega el id del grupo dueño */
            grp = getgrgid(st.st_gid);
            sprintf(buff, "%s", grp->gr_name);
            addHeader(buff, filename);

            /* Agrega el numero de bloques de 512 bytes guardados en memoria */
            sprintf(buff, "%li", st.st_blocks);
            addHeader(buff, filename);

            /* Agrega el tamaño del archivo en bytes */
            sprintf(buff, "%li", st.st_size);
            addHeader(buff, filename);
            addHeader("ENDHEADER", filename);
        }
        else if (S_ISREG(mode) && strcmp(basePath, filename))
        {
            /* Si es archivo regular y si el archivo a empaquetar no es una version de si mismo */

            /* Copia la direccion del path en un string */
            strcpy(str, basePath);

            /* Comienza el copiado del header en el archivo a empaquetar */
            addHeader("STARTHEADER", filename);

            /* Agrega direccion relativa del archivo o directorio */
            addHeader(str, filename);

            /* Agrega el modo del archivo */
            sprintf(buff, "%i", st.st_mode);
            addHeader(buff, filename);

            /* Agrega el username del dueño del archivo */
            pws = getpwuid(st.st_uid);
            sprintf(buff, "%s", pws->pw_name);
            addHeader(buff, filename);

            /* Agrega el id del grupo dueño */
            grp = getgrgid(st.st_gid);
            sprintf(buff, "%s", grp->gr_name);
            addHeader(buff, filename);

            /* Agrega el numero de bloques de 512 bytes guardados en memoria */
            sprintf(buff, "%li", st.st_blocks);
            addHeader(buff, filename);

            /* Agrega el tamaño del archivo en bytes */
            sprintf(buff, "%li", st.st_size);
            addHeader(buff, filename);
            addHeader("ENDHEADER", filename);

            /* Copia toda la data del archivo en el paquete */
            addHeader("STARTPROGRAM", filename);
            addContent(fichero, filename);
            addHeader("ENDPROGRAM", filename);
        }
        else if (n && S_ISLNK(mode))
        {
            /* Si es link */
            /* Copia la direccion del path en un string */
            strcpy(str, basePath);

            /* Comienza el copiado del header en el archivo a empaquetar */
            addHeader("STARTHEADER", filename);

            /* Agrega direccion relativa del archivo o directorio */
            addHeader(str, filename);

            /* Agrega el modo del archivo */
            sprintf(buff, "%i", st.st_mode);
            addHeader(buff, filename);

            /* Agrega el username del dueño del archivo */
            pws = getpwuid(st.st_uid);
            sprintf(buff, "%s", pws->pw_name);
            addHeader(buff, filename);

            /* Agrega el id del grupo dueño */
            grp = getgrgid(st.st_gid);
            sprintf(buff, "%s", grp->gr_name);
            addHeader(buff, filename);

            /* Agrega el numero de bloques de 512 bytes guardados en memoria */
            sprintf(buff, "%li", st.st_blocks);
            addHeader(buff, filename);

            /* Agrega el tamaño del archivo en bytes */
            sprintf(buff, "%li", st.st_size);
            addHeader(buff, filename);
            addHeader("ENDHEADER", filename);

            /* Copia toda la data del archivo en el paquete */
            addHeader("STARTPROGRAM", filename);
            addContent(fichero, filename);
            addHeader("ENDPROGRAM", filename);
        }
        else if (n && (S_ISBLK(mode) || S_ISCHR(mode) || S_ISFIFO(mode) || S_ISLNK(mode)))
        {
        }
        else if (fichero == NULL)
        {
            /* Si no existe ningun archivo o directorio con ese nombre */
        }

        fclose(fichero);

        /* Abre el directorio con la direccion especifica */
        dir = opendir(basePath);

        /* Si no existe tal directorio entonces se sale de la funcion */
        if (dir == NULL)
        {
            return;
        }

        /* Mientras existe un apuntador que devuelva readdir(), se seguira en el ciclo */
        while ((dp = readdir(dir)) != NULL)
        {
            /* Mientras el directorio no sea el base, realiza unas actividades especiales para una correcta impresion */
            if (strcmp(dp->d_name, ".") != 0 && strcmp(dp->d_name, "..") != 0)
            {
                /* Imprime en pantalla el nombre del archivo actual */
                if (v)
                {
                    printf("packing... %s \n", dp->d_name);
                }

                /* Copia hacia la variable path el nuevo directorio base */
                strcpy(path, basePath);
                strcat(path, "/");
                strcat(path, dp->d_name);

                /* LLamada recursiva hacia el nuevo directorio hijo, trasladando el root por 2 */
                packing(path, filename, root + 2, n, v);
            }
        }
        /* Cierra el actual directorio para liberar el espacio de memoria */
        closedir(dir);
    }
}
ENDPROGRAM
STARTHEADER
./packing.h
33204
samuel
samuel
8
119
ENDHEADER
STARTPROGRAM
#ifndef PACKING_h
#define PACKING_h

void packing(char *basePath, char *filename,const int root, int n, int v);

#endif
ENDPROGRAM
STARTHEADER
./mytar
33277
samuel
samuel
40
17728
ENDHEADER
STARTPROGRAM
ELF          >          @        >          @ 8 	 @         @       @       @                                8      8      8                                                         8"      8"                    -      -      -                                 (-      (-      (-                               T      T      T      D       D              Ptd                     t       t              Qtd                                                  Rtd   -      -      -                         /lib64/ld-linux-x86-64.so.2          GNU                        GNU F9GV83d	n                                                                                                                        f                      {                      (                      C                                            :                      `                                            T                      1                      Z                                                                                                                                     m                      "                                            t                                                                     "                    libc.so.6 strcpy readdir sprintf fopen getpwuid closedir getgrgid __stack_chk_fail fgetc fputc fputs fclose malloc strcat opendir fscanf atoi __cxa_finalize strcmp __libc_start_main free __xstat GLIBC_2.4 GLIBC_2.2.5 _ITM_deregisterTMCloneTable __gmon_start__ _ITM_registerTMCloneTable                                               ii         ui	          -                    -                   0             0      /                    /                    /                    /                    /                    0/                    8/                    @/                    H/                    P/                    X/                    `/                    h/         	           p/         
           x/                    /                    /                    /                    /                    /                    /                    /                    /                    /                    /                    /                    HH]&  HtH         5z%  %|%  @ %z%  h    %r%  h   %j%  h   %b%  h   %Z%  h   %R%  h   %J%  h   %B%  h   p%:%  h   `%2%  h	   P%*%  h
   @%"%  h   0%%  h    %%  h   %
%  h    %%  h   %$  h   %$  h   %$  h   %$  h   %$  h   %$  f        1I^HHPTL  Hs  H=   $  D  H=$  UH$  H9HtHz$  Ht]f.     ]@ f.     H=$  H5$  UH)HHHH?HHtHA$  Ht]f     ]@ f.     =9$   u/H=$   UHtH=$  H$  ]    fD  UH]fUHHp  HdH%(   HE1Hf   HHH  Hf   HHH @HH5  HtiHH5  HtOHH5z  Ht5Hf ./@ HHHHHH   HH5+  H_u"HHHHHH{THH5  H#u:HH5  H	u HHHHHH%HHH=      ZHA          HH=o        HMdH3%(   tUH}uEU։    +EU	]UH}uEU։    +EU	]UHHN  HHdH%(   HE1d   1Hd    Hd   Hd   Hd   Hd   HHH5g  HHȱǅ      ƅ HбH56  H\{  HбHȱH5  HǸ    HбHHHYHбHȱH5  HǸ    HбHHHHH%   = @  u	H  H  HHH%   t	HO  HY  HHH%   t	H3  H(  HHH@t	H  H  HHHd t	H  H  HHH5t	H  H  HHHt	Hy  Hl  HHHt	H3  H=  HHHt	H  H  HHHyt	H  H  HHHJHHH¸    HHHHPHHf   %   =   u	H  Hw  HHHHбHȱH5K  HǸ     HбHHHHбHȱH5  HǸ    HбHHHLHбHȱH5  HǸ    HбHȱH5  HǸ    HбHHHHHHHH¸    HHHHPHHf   HHHHHHH¸    HHHHPHHf   HHHH`HHH¸    HHHHPHHf   HHHHHHH¸    HHHHPHHf   HHHHHHH¸    HHHHPHHH      	 H0@ HHHHmHHH¸    HHHHPHHf 
 HHH=
      NHбHȱH5
  HǸ    \H=t
      
HHHHHH}HHnHH_HȱHp    HMdH3%(   tUHH H}HuHEH5	  H"HEHUHEHH{HEHƿ
   HEH    UHH H}HuHEH5	  HHEE    H} t(HUEH։OHEH#E}uHEHƿ
   )HEH}HEHq    UHH,  H(H DdH%(   HE1H(H5  H	H8H8   H`H(HH;  x44%   = @    H(HHHH HH=e  EH HHH,xHH5?  HǸ    H HHH|ZH@H@HHHHH HHHAHHHHHHHHH HHH`HHH5u  HǸ    H HHH%HHH5:  HǸ    xH HHHH HH=  h  4%   =     H H(HH  H(HHHH HH=  iH HHHPxHH5c  HǸ    H HHH|~H@H@HHHH+H HHHeHHHHHHHHH HHHHHH5  HǸ    H HHHIHHH5^  HǸ    H HHHH HH=+  H HH=  H H8HH'H HH=  G   :  4%   =     H(HHHH HH=|  \H HHHCxHH5V  HǸ    H HHH	|qH@H@HHHHH HHHXHHHHHHHHH HHHwHHH5  HǸ    H HHH<HHH5Q  HǸ    H HHHH HH=  H HH=  H H8HHH HH=  = t44%   = `  t"4%   =    t4%   =   H8HH(HHPHP B    HXHH5m  H   HXHH5M  H    tHXHHH="      XH(HHHHHH¸    HHHHPHHf / HXHPHHHxH HAȉщHHPH=HXHX HPHHEdH3%(   tbAWAVIAUATL%f  UH-f  SAIL)HHHt 1     LLDAHH9uH[]A\A]A^A_Ðf.     f.     @ HH   `HH         / . %s 
    r STARTHEADER %s d - w x l      
Total bytes of files packed: %i
 a r STARTHEADER %i %li ENDHEADER STARTPROGRAM ENDPROGRAM . .. packing... %s 
 ;t             0   :      B@  m`          0(  @@             zR x      +                  zR x  $      `   FJw ?;*3$"       D   0              \   2   AC    |   +    ACf         +    ACf         .   AC)       ^    ACY        Q    AC       :   AC5 D   <  e    BBE B(H0H8M@r8A0A(B BBB                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   	             0             -                            -                    o                 @                   
                                                 /                                                                         	                            o          o          o           o    `      o                                                                                           (-                      	      	      	      	      	      
      
      &
      6
      F
      V
      f
      v
      
      
      
      
      
      
      
      
                                                      0      GCC: (Ubuntu 7.4.0-1ubuntu1~18.04.1) 7.4.0                                    8                    T                    t                                                            @                    `                                       	                    
                     	                    	                                                             0                    @                                        X                     -                     -                    (-                    /                     0                    0                                                             @                                 !                   7     0             F      -              m                   y     -                                                                                                                       4"                                   2                         -                   (-                    -                                  
    /                                0                 7                     I                 T                            0              p                         M      .          0                                                                             *    0                                                                                       +                            )                     =                     P                     f    f      :      n                                              {      ^            0                                                            0                  @                                                                  e       0                          0              D    "      +                 +       Q    0              ]                b                     u                                                                  0                                      "                   *    	               crtstuff.c deregister_tm_clones __do_global_dtors_aux completed.7697 __do_global_dtors_aux_fini_array_entry frame_dummy __frame_dummy_init_array_entry main.c encrypted.c look.c packing.c __FRAME_END__ __init_array_end _DYNAMIC __init_array_start __GNU_EH_FRAME_HDR _GLOBAL_OFFSET_TABLE_ __libc_csu_fini __stat free@@GLIBC_2.2.5 addContent _ITM_deregisterTMCloneTable strcpy@@GLIBC_2.2.5 packedInfo _edata fclose@@GLIBC_2.2.5 opendir@@GLIBC_2.2.5 getpwuid@@GLIBC_2.2.5 __stack_chk_fail@@GLIBC_2.4 getgrgid@@GLIBC_2.2.5 rotarIzquierda fputs@@GLIBC_2.2.5 fscanf@@GLIBC_2.2.5 fgetc@@GLIBC_2.2.5 closedir@@GLIBC_2.2.5 packing fputc@@GLIBC_2.2.5 __libc_start_main@@GLIBC_2.2.5 addHeader __data_start strcmp@@GLIBC_2.2.5 __gmon_start__ __dso_handle _IO_stdin_used __xstat@@GLIBC_2.2.5 readdir@@GLIBC_2.2.5 __libc_csu_init malloc@@GLIBC_2.2.5 rotarDerecha __bss_start main fopen@@GLIBC_2.2.5 atoi@@GLIBC_2.2.5 strcat@@GLIBC_2.2.5 sprintf@@GLIBC_2.2.5 __TMC_END__ _ITM_registerTMCloneTable __cxa_finalize@@GLIBC_2.2.5  .symtab .strtab .shstrtab .interp .note.ABI-tag .note.gnu.build-id .gnu.hash .dynsym .dynstr .gnu.version .gnu.version_r .rela.dyn .rela.plt .init .plt.got .text .fini .rodata .eh_frame_hdr .eh_frame .init_array .fini_array .dynamic .data .bss .comment                                                                              8      8                                    #             T      T                                     1             t      t      $                              D   o                                                N                                                   V             @      @                                   ^   o       `      `      6                            k   o                   0                            z                                                           B                                                          	      	                                                 	      	      `                                                                                                                                                        0      0      	                                           @      @                                                             t                                           X       X                                                 -      -                                                 -       -                                                (-      (-                                              /      /                                                 0       0                                                 0      0                                          0               0      +                                                   @0               /                 	                      9                                                         =                                    
ENDPROGRAM
STARTHEADER
./encrypted.o
33204
samuel
samuel
8
1416
ENDHEADER
STARTPROGRAM
ELF          >                              @     @  
 UH}uEU։    +EU	]UH}uEU։    +EU	] GCC: (Ubuntu 7.4.0-1ubuntu1~18.04.1) 7.4.0              zR x            +    ACf      <       +    ACf                                                                                                                                                                                                +            +       +        encrypted.c rotarIzquierda rotarDerecha                              @             +        .symtab .strtab .shstrtab .text .data .bss .comment .note.GNU-stack .rela.eh_frame                                                                                          @       V                              !                                                           '                                                           ,      0                      ,                             5                                                            J                            X                              E      @               @      0                                                               	                    	                            )                                                    p      T                              
ENDPROGRAM
STARTHEADER
./look.o
33204
samuel
samuel
16
5608
ENDHEADER
STARTPROGRAM
ELF          >                              @     @   UHHN  HHdH%(   HE1d       Hd       Hd       Hd       Hd       Hd       HHH5    H    Hȱǅ      ƅ HбH5    H    {  HбHȱH5    HǸ        HбHHH    HбHȱH5    HǸ        HбHHH    HH    %   = @  u	H    H    HHH    %   t	H    H    HHH    %   t	H    H    HHH    @t	H    H    HHH     t	H    H    HHH    t	H    H    HHH    t	H    H    HHH    t	H    H    HHH    t	H    H    HHH    t	H    H    HHH    HHH¸    HHHHPHHf   %   =   u	H    H    HHH    HбHȱH5    HǸ        HбHHH    HбHȱH5    HǸ        HбHHH    HбHȱH5    HǸ        HбHȱH5    HǸ        HбHHH    HH    HHH¸    HHHHPHHf   HHHH    HHH¸    HHHHPHHf   HHHH    HHH¸    HHHHPHHf   HHHH    HHH¸    HHHHPHHf   HHHH    HHH¸    HHHHPHHH      	 H0@ HHHH    HHH¸    HHHHPHHf 
 HHH=            HбHȱH5    HǸ        H=            HH    HH    HH    HH    HH    HȱH        HMdH3%(   t      r STARTHEADER %s d - w x l      
Total bytes of files packed: %i
  GCC: (Ubuntu 7.4.0-1ubuntu1~18.04.1) 7.4.0          zR x            .   AC)                                                                                                                                                                                                                    .                            )                      0                      6                      =                      D                      K                      P                      W                      ^                      c                      j                       look.c packedInfo _GLOBAL_OFFSET_TABLE_ malloc fopen strcmp fscanf strcpy atoi strcat printf free fclose __stack_chk_fail      .             ?             P             a             r                                                                                           
                                +            
       8            Q            `                                                                                                                                                                                                 +            ?            H                   Z            n                   w                                                                                                                                                                              *                   3                   E                                                                          
                                           
       
            #            8            
       E            Z            
       g                                                /            |                        "            g            
       q                        
                                                                                                                           (                                   .symtab .strtab .shstrtab .rela.text .data .bss .rodata .comment .note.GNU-stack .rela.eh_frame                                                                                              @       .                                   @               
            
                    &                     n                                     ,                     n                                     1                     p      B                              9      0                     ,                             B                                                           W                           8                              R      @               (             
                                                         	                 	                      (
      {                                                    @      a                              
ENDPROGRAM
STARTHEADER
./.vscode
16893
samuel
samuel
8
4096
ENDHEADER
STARTHEADER
./.vscode/settings.json
33204
samuel
samuel
8
109
ENDHEADER
STARTPROGRAM
{
    "files.associations": {
        "stat.h": "c",
        "unistd.h": "c",
        "stdlib.h": "c"
    }
}
ENDPROGRAM
STARTHEADER
.
16893
samuel
samuel
8
4096
ENDHEADER
STARTHEADER
./packing.c
33204
samuel
samuel
16
8183
ENDHEADER
STARTPROGRAM

/* LIBRERIAS DEL SISTEMA QUE UTILIZA PACKING.C */
#include <stdio.h>
#include <string.h>
#include <sys/types.h>
#include <sys/stat.h>
#include <dirent.h>
#include <unistd.h>
#include <stdlib.h>
#include <pwd.h>
#include <grp.h>

/*
* Funcion:
* --------------------------
* 
 
* basePath: 
* root:

* return: 
*/

int addHeader(char *data, char *filename)
{
    FILE *fichero;
    fichero = fopen(filename, "a");
    fputs(data, fichero);
    fputs("\n", fichero);
    fclose(fichero);
    return 0;
}

/*
* Funcion:
* --------------------------
* 
 
* basePath: 
* root:

* return: 
*/

int addContent(FILE *data, char *filename)
{
    FILE *fichero;
    int data1;
    fichero = fopen(filename, "a");
    data1 = 0;
    if (data != NULL)
    {
        while ((data1 = fgetc(data)) != EOF)
        {
            fputc(data1, fichero);
        }
    }
    fputs("\n", fichero);
    fclose(data);
    fclose(fichero);
    return 0;
}

/*
* Funcion: recursiveTree
* --------------------------
* Encargada de hacer un recorrido por todo el arbol de directorio y de archivos, es decir,
  pasando por cada archivo/directorio dentro de una direccion en especifico.
 
* basePath: La direccion base por la que comenzara el recorrido del arbol
* filename
* root: Un entero que representa el nivel del arbol.
* n: Es el identificador del flag n
* v: Es el identificador del flag v

* return: nada.
*/

void packing(char *basePath, char *filename, const int root, int n, int v)
{
    /* Se encarga de inicializar las variables que usaremos en el recorrido */
    int i;
    char path[1000];
    char str[255];
    char buff[10000];

    /* Crea un struct dirent que contiene informacion del directorio */
    struct dirent *dp;

    /* Inicializan variables para poder conocer informacion del archivo */
    struct stat st;
    struct passwd *pws;
    struct group *grp;
    mode_t mode;

    /* Se crea variable que contendra el archivo a empaquetar */
    FILE *fichero;

    /* Inicializa directorios a recorrer */
    DIR *dir;

    /* Abre lo que se encuentre en la direccion que se pasa por argumento */
    fichero = fopen(basePath, "r");
    if (fichero != NULL)
    {
        /* Consigue el stat de lo que pasamos como argumento y lo linkea a nuestra variable personal creada para el caso */
        stat(basePath, &st);

        /* Encuentra el mode, para verificar que tipo de archivo tenemos a la mano */
        mode = st.st_mode;

        if (S_ISDIR(mode))
        {
            /* Si es directorio */
            strcpy(str, basePath);

            /* Comienza el copiado del header en el archivo a empaquetar */
            addHeader("STARTHEADER", filename);

            /* Agrega direccion relativa del archivo o directorio */
            addHeader(str, filename);

            /* Agrega el modo del archivo */
            sprintf(buff, "%i", st.st_mode);
            addHeader(buff, filename);

            /* Agrega el username del dueño del archivo */
            pws = getpwuid(st.st_uid);
            sprintf(buff, "%s", pws->pw_name);
            addHeader(buff, filename);

            /* Agrega el id del grupo dueño */
            grp = getgrgid(st.st_gid);
            sprintf(buff, "%s", grp->gr_name);
            addHeader(buff, filename);

            /* Agrega el numero de bloques de 512 bytes guardados en memoria */
            sprintf(buff, "%li", st.st_blocks);
            addHeader(buff, filename);

            /* Agrega el tamaño del archivo en bytes */
            sprintf(buff, "%li", st.st_size);
            addHeader(buff, filename);
            addHeader("ENDHEADER", filename);
        }
        else if (S_ISREG(mode) && strcmp(basePath, filename))
        {
            /* Si es archivo regular y si el archivo a empaquetar no es una version de si mismo */

            /* Copia la direccion del path en un string */
            strcpy(str, basePath);

            /* Comienza el copiado del header en el archivo a empaquetar */
            addHeader("STARTHEADER", filename);

            /* Agrega direccion relativa del archivo o directorio */
            addHeader(str, filename);

            /* Agrega el modo del archivo */
            sprintf(buff, "%i", st.st_mode);
            addHeader(buff, filename);

            /* Agrega el username del dueño del archivo */
            pws = getpwuid(st.st_uid);
            sprintf(buff, "%s", pws->pw_name);
            addHeader(buff, filename);

            /* Agrega el id del grupo dueño */
            grp = getgrgid(st.st_gid);
            sprintf(buff, "%s", grp->gr_name);
            addHeader(buff, filename);

            /* Agrega el numero de bloques de 512 bytes guardados en memoria */
            sprintf(buff, "%li", st.st_blocks);
            addHeader(buff, filename);

            /* Agrega el tamaño del archivo en bytes */
            sprintf(buff, "%li", st.st_size);
            addHeader(buff, filename);
            addHeader("ENDHEADER", filename);

            /* Copia toda la data del archivo en el paquete */
            addHeader("STARTPROGRAM", filename);
            addContent(fichero, filename);
            addHeader("ENDPROGRAM", filename);
        }
        else if (n && S_ISLNK(mode))
        {
            /* Si es link */
            /* Copia la direccion del path en un string */
            strcpy(str, basePath);

            /* Comienza el copiado del header en el archivo a empaquetar */
            addHeader("STARTHEADER", filename);

            /* Agrega direccion relativa del archivo o directorio */
            addHeader(str, filename);

            /* Agrega el modo del archivo */
            sprintf(buff, "%i", st.st_mode);
            addHeader(buff, filename);

            /* Agrega el username del dueño del archivo */
            pws = getpwuid(st.st_uid);
            sprintf(buff, "%s", pws->pw_name);
            addHeader(buff, filename);

            /* Agrega el id del grupo dueño */
            grp = getgrgid(st.st_gid);
            sprintf(buff, "%s", grp->gr_name);
            addHeader(buff, filename);

            /* Agrega el numero de bloques de 512 bytes guardados en memoria */
            sprintf(buff, "%li", st.st_blocks);
            addHeader(buff, filename);

            /* Agrega el tamaño del archivo en bytes */
            sprintf(buff, "%li", st.st_size);
            addHeader(buff, filename);
            addHeader("ENDHEADER", filename);

            /* Copia toda la data del archivo en el paquete */
            addHeader("STARTPROGRAM", filename);
            addContent(fichero, filename);
            addHeader("ENDPROGRAM", filename);
        }
        else if (n && (S_ISBLK(mode) || S_ISCHR(mode) || S_ISFIFO(mode) || S_ISLNK(mode)))
        {
        }
        else if (fichero == NULL)
        {
            /* Si no existe ningun archivo o directorio con ese nombre */
        }

        fclose(fichero);

        /* Abre el directorio con la direccion especifica */
        dir = opendir(basePath);

        /* Si no existe tal directorio entonces se sale de la funcion */
        if (dir == NULL)
        {
            return;
        }

        /* Mientras existe un apuntador que devuelva readdir(), se seguira en el ciclo */
        while ((dp = readdir(dir)) != NULL)
        {
            /* Mientras el directorio no sea el base, realiza unas actividades especiales para una correcta impresion */
            if (strcmp(dp->d_name, ".") != 0 && strcmp(dp->d_name, "..") != 0)
            {
                /* Imprime en pantalla el nombre del archivo actual */
                if (v)
                {
                    printf("packing... %s \n", dp->d_name);
                }

                /* Copia hacia la variable path el nuevo directorio base */
                strcpy(path, basePath);
                strcat(path, "/");
                strcat(path, dp->d_name);

                /* LLamada recursiva hacia el nuevo directorio hijo, trasladando el root por 2 */
                packing(path, filename, root + 2, n, v);
            }
        }
        /* Cierra el actual directorio para liberar el espacio de memoria */
        closedir(dir);
    }
}
ENDPROGRAM
STARTHEADER
./packing.h
33204
samuel
samuel
8
119
ENDHEADER
STARTPROGRAM
#ifndef PACKING_h
#define PACKING_h

void packing(char *basePath, char *filename,const int root, int n, int v);

#endif
ENDPROGRAM
STARTHEADER
./mytar
33277
samuel
samuel
40
17728
ENDHEADER
STARTPROGRAM
ELF          >          @        >          @ 8 	 @         @       @       @                                8      8      8                                                         8"      8"                    -      -      -                                 (-      (-      (-                               T      T      T      D       D              Ptd                     t       t              Qtd                                                  Rtd   -      -      -                         /lib64/ld-linux-x86-64.so.2          GNU                        GNU F9GV83d	n                                                                                                                        f                      {                      (                      C                                            :                      `                                            T                      1                      Z                                                                                                                                     m                      "                                            t                                                                     "                    libc.so.6 strcpy readdir sprintf fopen getpwuid closedir getgrgid __stack_chk_fail fgetc fputc fputs fclose malloc strcat opendir fscanf atoi __cxa_finalize strcmp __libc_start_main free __xstat GLIBC_2.4 GLIBC_2.2.5 _ITM_deregisterTMCloneTable __gmon_start__ _ITM_registerTMCloneTable                                               ii         ui	          -                    -                   0             0      /                    /                    /                    /                    /                    0/                    8/                    @/                    H/                    P/                    X/                    `/                    h/         	           p/         
           x/                    /                    /                    /                    /                    /                    /                    /                    /                    /                    /                    /                    HH]&  HtH         5z%  %|%  @ %z%  h    %r%  h   %j%  h   %b%  h   %Z%  h   %R%  h   %J%  h   %B%  h   p%:%  h   `%2%  h	   P%*%  h
   @%"%  h   0%%  h    %%  h   %
%  h    %%  h   %$  h   %$  h   %$  h   %$  h   %$  h   %$  f        1I^HHPTL  Hs  H=   $  D  H=$  UH$  H9HtHz$  Ht]f.     ]@ f.     H=$  H5$  UH)HHHH?HHtHA$  Ht]f     ]@ f.     =9$   u/H=$   UHtH=$  H$  ]    fD  UH]fUHHp  HdH%(   HE1Hf   HHH  Hf   HHH @HH5  HtiHH5  HtOHH5z  Ht5Hf ./@ HHHHHH   HH5+  H_u"HHHHHH{THH5  H#u:HH5  H	u HHHHHH%HHH=      ZHA          HH=o        HMdH3%(   tUH}uEU։    +EU	]UH}uEU։    +EU	]UHHN  HHdH%(   HE1d   1Hd    Hd   Hd   Hd   Hd   HHH5g  HHȱǅ      ƅ HбH56  H\{  HбHȱH5  HǸ    HбHHHYHбHȱH5  HǸ    HбHHHHH%   = @  u	H  H  HHH%   t	HO  HY  HHH%   t	H3  H(  HHH@t	H  H  HHHd t	H  H  HHH5t	H  H  HHHt	Hy  Hl  HHHt	H3  H=  HHHt	H  H  HHHyt	H  H  HHHJHHH¸    HHHHPHHf   %   =   u	H  Hw  HHHHбHȱH5K  HǸ     HбHHHHбHȱH5  HǸ    HбHHHLHбHȱH5  HǸ    HбHȱH5  HǸ    HбHHHHHHHH¸    HHHHPHHf   HHHHHHH¸    HHHHPHHf   HHHH`HHH¸    HHHHPHHf   HHHHHHH¸    HHHHPHHf   HHHHHHH¸    HHHHPHHH      	 H0@ HHHHmHHH¸    HHHHPHHf 
 HHH=
      NHбHȱH5
  HǸ    \H=t
      
HHHHHH}HHnHH_HȱHp    HMdH3%(   tUHH H}HuHEH5	  H"HEHUHEHH{HEHƿ
   HEH    UHH H}HuHEH5	  HHEE    H} t(HUEH։OHEH#E}uHEHƿ
   )HEH}HEHq    UHH,  H(H DdH%(   HE1H(H5  H	H8H8   H`H(HH;  x44%   = @    H(HHHH HH=e  EH HHH,xHH5?  HǸ    H HHH|ZH@H@HHHHH HHHAHHHHHHHHH HHH`HHH5u  HǸ    H HHH%HHH5:  HǸ    xH HHHH HH=  h  4%   =     H H(HH  H(HHHH HH=  iH HHHPxHH5c  HǸ    H HHH|~H@H@HHHH+H HHHeHHHHHHHHH HHHHHH5  HǸ    H HHHIHHH5^  HǸ    H HHHH HH=+  H HH=  H H8HH'H HH=  G   :  4%   =     H(HHHH HH=|  \H HHHCxHH5V  HǸ    H HHH	|qH@H@HHHHH HHHXHHHHHHHHH HHHwHHH5  HǸ    H HHH<HHH5Q  HǸ    H HHHH HH=  H HH=  H H8HHH HH=  = t44%   = `  t"4%   =    t4%   =   H8HH(HHPHP B    HXHH5m  H   HXHH5M  H    tHXHHH="      XH(HHHHHH¸    HHHHPHHf / HXHPHHHxH HAȉщHHPH=HXHX HPHHEdH3%(   tbAWAVIAUATL%f  UH-f  SAIL)HHHt 1     LLDAHH9uH[]A\A]A^A_Ðf.     f.     @ HH   `HH         / . %s 
    r STARTHEADER %s d - w x l      
Total bytes of files packed: %i
 a r STARTHEADER %i %li ENDHEADER STARTPROGRAM ENDPROGRAM . .. packing... %s 
 ;t             0   :      B@  m`          0(  @@             zR x      +                  zR x  $      `   FJw ?;*3$"       D   0              \   2   AC    |   +    ACf         +    ACf         .   AC)       ^    ACY        Q    AC       :   AC5 D   <  e    BBE B(H0H8M@r8A0A(B BBB                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   	             0             -                            -                    o                 @                   
                                                 /                                                                         	                            o          o          o           o    `      o                                                                                           (-                      	      	      	      	      	      
      
      &
      6
      F
      V
      f
      v
      
      
      
      
      
      
      
      
                                                      0      GCC: (Ubuntu 7.4.0-1ubuntu1~18.04.1) 7.4.0                                    8                    T                    t                                                            @                    `                                       	                    
                     	                    	                                                             0                    @                                        X                     -                     -                    (-                    /                     0                    0                                                             @                                 !                   7     0             F      -              m                   y     -                                                                                                                       4"                                   2                         -                   (-                    -                                  
    /                                0                 7                     I                 T                            0              p                         M      .          0                                                                             *    0                                                                                       +                            )                     =                     P                     f    f      :      n                                              {      ^            0                                                            0                  @                                                                  e       0                          0              D    "      +                 +       Q    0              ]                b                     u                                                                  0                                      "                   *    	               crtstuff.c deregister_tm_clones __do_global_dtors_aux completed.7697 __do_global_dtors_aux_fini_array_entry frame_dummy __frame_dummy_init_array_entry main.c encrypted.c look.c packing.c __FRAME_END__ __init_array_end _DYNAMIC __init_array_start __GNU_EH_FRAME_HDR _GLOBAL_OFFSET_TABLE_ __libc_csu_fini __stat free@@GLIBC_2.2.5 addContent _ITM_deregisterTMCloneTable strcpy@@GLIBC_2.2.5 packedInfo _edata fclose@@GLIBC_2.2.5 opendir@@GLIBC_2.2.5 getpwuid@@GLIBC_2.2.5 __stack_chk_fail@@GLIBC_2.4 getgrgid@@GLIBC_2.2.5 rotarIzquierda fputs@@GLIBC_2.2.5 fscanf@@GLIBC_2.2.5 fgetc@@GLIBC_2.2.5 closedir@@GLIBC_2.2.5 packing fputc@@GLIBC_2.2.5 __libc_start_main@@GLIBC_2.2.5 addHeader __data_start strcmp@@GLIBC_2.2.5 __gmon_start__ __dso_handle _IO_stdin_used __xstat@@GLIBC_2.2.5 readdir@@GLIBC_2.2.5 __libc_csu_init malloc@@GLIBC_2.2.5 rotarDerecha __bss_start main fopen@@GLIBC_2.2.5 atoi@@GLIBC_2.2.5 strcat@@GLIBC_2.2.5 sprintf@@GLIBC_2.2.5 __TMC_END__ _ITM_registerTMCloneTable __cxa_finalize@@GLIBC_2.2.5  .symtab .strtab .shstrtab .interp .note.ABI-tag .note.gnu.build-id .gnu.hash .dynsym .dynstr .gnu.version .gnu.version_r .rela.dyn .rela.plt .init .plt.got .text .fini .rodata .eh_frame_hdr .eh_frame .init_array .fini_array .dynamic .data .bss .comment                                                                              8      8                                    #             T      T                                     1             t      t      $                              D   o                                                N                                                   V             @      @                                   ^   o       `      `      6                            k   o                   0                            z                                                           B                                                          	      	                                                 	      	      `                                                                                                                                                        0      0      	                                           @      @                                                             t                                           X       X                                                 -      -                                                 -       -                                                (-      (-                                              /      /                                                 0       0                                                 0      0                                          0               0      +                                                   @0               /                 	                      9                                                         =                                    
ENDPROGRAM
STARTHEADER
./encrypted.o
33204
samuel
samuel
8
1416
ENDHEADER
STARTPROGRAM
ELF          >                              @     @  
 UH}uEU։    +EU	]UH}uEU։    +EU	] GCC: (Ubuntu 7.4.0-1ubuntu1~18.04.1) 7.4.0              zR x            +    ACf      <       +    ACf                                                                                                                                                                                                +            +       +        encrypted.c rotarIzquierda rotarDerecha                              @             +        .symtab .strtab .shstrtab .text .data .bss .comment .note.GNU-stack .rela.eh_frame                                                                                          @       V                              !                                                           '                                                           ,      0                      ,                             5                                                            J                            X                              E      @               @      0                                                               	                    	                            )                                                    p      T                              
ENDPROGRAM
STARTHEADER
./look.o
33204
samuel
samuel
16
5608
ENDHEADER
STARTPROGRAM
ELF          >                              @     @   UHHN  HHdH%(   HE1d       Hd       Hd       Hd       Hd       Hd       HHH5    H    Hȱǅ      ƅ HбH5    H    {  HбHȱH5    HǸ        HбHHH    HбHȱH5    HǸ        HбHHH    HH    %   = @  u	H    H    HHH    %   t	H    H    HHH    %   t	H    H    HHH    @t	H    H    HHH     t	H    H    HHH    t	H    H    HHH    t	H    H    HHH    t	H    H    HHH    t	H    H    HHH    t	H    H    HHH    HHH¸    HHHHPHHf   %   =   u	H    H    HHH    HбHȱH5    HǸ        HбHHH    HбHȱH5    HǸ        HбHHH    HбHȱH5    HǸ        HбHȱH5    HǸ        HбHHH    HH    HHH¸    HHHHPHHf   HHHH    HHH¸    HHHHPHHf   HHHH    HHH¸    HHHHPHHf   HHHH    HHH¸    HHHHPHHf   HHHH    HHH¸    HHHHPHHH      	 H0@ HHHH    HHH¸    HHHHPHHf 
 HHH=            HбHȱH5    HǸ        H=            HH    HH    HH    HH    HH    HȱH        HMdH3%(   t      r STARTHEADER %s d - w x l      
Total bytes of files packed: %i
  GCC: (Ubuntu 7.4.0-1ubuntu1~18.04.1) 7.4.0          zR x            .   AC)                                                                                                                                                                                                                    .                            )                      0                      6                      =                      D                      K                      P                      W                      ^                      c                      j                       look.c packedInfo _GLOBAL_OFFSET_TABLE_ malloc fopen strcmp fscanf strcpy atoi strcat printf free fclose __stack_chk_fail      .             ?             P             a             r                                                                                           
                                +            
       8            Q            `                                                                                                                                                                                                 +            ?            H                   Z            n                   w                                                                                                                                                                              *                   3                   E                                                                          
                                           
       
            #            8            
       E            Z            
       g                                                /            |                        "            g            
       q                        
                                                                                                                           (                                   .symtab .strtab .shstrtab .rela.text .data .bss .rodata .comment .note.GNU-stack .rela.eh_frame                                                                                              @       .                                   @               
            
                    &                     n                                     ,                     n                                     1                     p      B                              9      0                     ,                             B                                                           W                           8                              R      @               (             
                                                         	                 	                      (
      {                                                    @      a                              
ENDPROGRAM
STARTHEADER
./.vscode
16893
samuel
samuel
8
4096
ENDHEADER
STARTHEADER
./.vscode/settings.json
33204
samuel
samuel
8
109
ENDHEADER
STARTPROGRAM
{
    "files.associations": {
        "stat.h": "c",
        "unistd.h": "c",
        "stdlib.h": "c"
    }
}
ENDPROGRAM
